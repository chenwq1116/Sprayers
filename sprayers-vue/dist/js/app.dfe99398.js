(function(){"use strict";var t={757:function(t,e,n){var s=n(144),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app"},[n("sprayers-header"),n("sprayers-main")],1)},o=[],a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main"},[n("sprayers-side",{attrs:{title:t.title_Note}},t._l(t.notes,(function(e,s){return n("span",{key:s,staticClass:"main-group",on:{click:function(n){return t.toNoteContent(e.name)}}},[t._v(t._s(e.name))])})),0),n("div",{staticClass:"main-content"},[n("router-view")],1),n("sprayers-side",{attrs:{title:t.title_HotTop}},t._l(t.topicTop,(function(e,s){return n("span",{key:s,staticClass:"main-group",on:{click:function(n){return t.toTopicContent(e.name)}}},[t._v(t._s(e.name))])})),0)],1)},r=[],c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content-basic main-side"},[n("h1",[t._v(t._s(t.title))]),n("div",{staticClass:"side-group"},[t._t("default")],2)])},l=[],u={name:"SprayersSide",props:["title"]},m=u,p=n(1),d=(0,p.Z)(m,c,l,!1,null,null,null),h=d.exports,g=n(629),f={name:"SprayersMain",components:{sprayersSide:h},computed:{...(0,g.rn)({topicTop:t=>t.content.topicTop,notes:t=>t.content.note})},data(){return{title_Note:"Note",title_HotTop:"Hot Topic"}},created:function(){this.getTopicTop(),this.getNoteList()},methods:{...(0,g.nv)({getTopicTop:"content/getTopicTop",getNoteList:"content/getNoteList"}),toTopicContent(t){t=t.replaceAll("#","%23"),window.location="/#/topic/"+t},toNoteContent(t){t=t.replaceAll("$","%24"),window.location="/#/note/"+t}}},_=f,y=(0,p.Z)(_,a,r,!1,null,null,null),v=y.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("div",{staticClass:"contains header-contains"},[t._m(0),n("div",{staticClass:"contains-right"},[n("div",{staticClass:"menu"},t._l(t.menuRouter,(function(e,s){return n("router-link",{key:s,staticClass:"menu-item",attrs:{to:e.to}},[n("div",[t._v(t._s(e.name))])])})),1)])])])},b=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"contains-left"},[n("img",{attrs:{src:"sprayers.png"}})])}],w={name:"SprayersHeader",data(){return{menuRouter:[{name:"Home🏡",to:"/"}]}}},k=w,x=(0,p.Z)(k,C,b,!1,null,null,null),L=x.exports,T={name:"App",components:{SprayersMain:v,SprayersHeader:L}},S=T,E=(0,p.Z)(S,i,o,!1,null,null,null),D=E.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content-home"},[n("div",{staticClass:"content-basic home-top"},[n("sprayers-text-area",{attrs:{submitType:"home"}})],1),t._l(t.sprayersData,(function(t,e){return n("sprayers-box",{key:e,attrs:{sprayersData:t}})}))],2)},I=[],P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content-basic home-textArea"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{maxlength:t.maxLengthLimit},domProps:{value:t.message},on:{input:[function(e){e.target.composing||(t.message=e.target.value)},function(e){return t.textMsg()}],change:function(e){return t.textMsg()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.shiftKey?t.submitContent():null}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.uploadFiles.length>0,expression:"uploadFiles.length > 0"}],staticClass:"home-img"},t._l(t.uploadFiles,(function(e,s){return n("div",{key:s,staticClass:"img"},[n("img",{staticClass:"img-bottom",attrs:{src:e.data}}),n("img",{staticClass:"imgs-top",attrs:{src:"del.png"},on:{click:function(e){return t.delImg(s)}}})])})),0),n("div",{staticClass:"home-bottom"},["home"==t.submitType?n("div",{staticClass:"home-tool"},[n("div",{staticClass:"tool-btn"},[n("div",{on:{click:function(e){return t.isShowEmoji()}}},[t._v("😃")]),n("VEmojiPicker",{directives:[{name:"show",rawName:"v-show",value:t.isEmoji,expression:"isEmoji"}],on:{select:t.selectEmoji}})],1),n("div",{staticClass:"tool-btn"},[n("input",{staticClass:"input-file",attrs:{type:"file",accept:"image/*",multiple:"true"},on:{change:function(e){return t.getFiles(e)}}}),t._v(" 📷 ")])]):t._e(),"home"!=t.submitType?n("div",{staticClass:"home-tool"},[n("div",{staticClass:"tool-btn"},[n("div",{on:{click:function(e){return t.isShowEmoji()}}},[t._v("😃")]),n("VEmojiPicker",{directives:[{name:"show",rawName:"v-show",value:t.isEmoji,expression:"isEmoji"}],on:{select:t.selectEmoji}})],1)]):t._e(),n("div",{staticClass:"home-send"},[n("div",[t._v(" "+t._s(t.maxlength)+"/120")]),n("button",{staticClass:"comment-btn",attrs:{type:"button"},on:{click:function(e){return t.submitContent()}}},[t._v("🗣")])])])])},$=[];function B(t){const e=new Date(t);return e.toLocaleString()}function N(t){let e=/#[a-zA-Z0-9\u4e00-\u9fa5]*#/g;const n=t.match(e);let s;for(s in console.log("topic:"+n),n){const e=n[s],i="<a href='#/topic/"+e.replaceAll("#","%23")+"'>"+e+"</a>";t=t.replace(e,i)}return t}function O(t){let e=/\$[a-zA-Z0-9\u4e00-\u9fa5]*\$/g;const n=t.match(e);let s;for(s in n){const e=n[s],i="<a href='#/note/"+e.replaceAll("$","%24")+"'>"+e+"</a>";t=t.replace(e,i)}return t}function M(t,e){return t.match(e)}function Z(t){let e=/#[a-zA-Z0-9\u4e00-\u9fa5]*#/g;return M(t,e)}function A(t){let e=/\$[a-zA-Z0-9\u4e00-\u9fa5]*\$/g;return M(t,e)}function F(t){var e=s["default"].$cookies.get(t);return e}function z(t,e){s["default"].$cookies.set(t,e,180)}var H={name:"SprayersTextArea",props:{submitType:{type:String,default:""},id:{type:String,default:""}},data(){return{message:"",text:"",isEmoji:!1,uploadFiles:[],maxlength:0,maxLengthLimit:120,picturesLengthLimit:9,picturesErrorMsg:"Pictures more than 9",messageErrorMsg:"Message more than 120",picturesSizeLimitErrorMsg:"Pictures more than 10m",uploadSizeLimit:10240}},computed:{isUploadOverSizeLimit(){let t=!1,e=0;const n=this.uploadFiles;let s;for(s in n){const t=n[s];null!=t&&(e+=t.size)}return this.uploadSizeLimit<=e&&(t=!0),t}},methods:{...(0,g.nv)({submitContentActions:"content/submitContent",getContentList:"content/getContentList",getContentByParentId:"content/getContentByParentId",insertTopics:"content/insertTopics",insertNote:"content/insertNote"}),...(0,g.OI)({addContentList:"content/addContentList",addCommentById:"content/addCommentById"}),delImg(t){this.uploadFiles.splice(t,1)},selectEmoji(t){this.message+=t.data,this.isEmoji=!1,this.textMsg()},isShowEmoji(){return this.isEmoji?this.isEmoji=!1:this.isEmoji=!0,this.isEmoji},getFiles(t){var e=t.target.files;let n;for(n in e){let t=e[n];var s=new FileReader;s.readAsDataURL(t);let i="",o=this;s.onload=function(){i=this.result.substring(this.result.indexOf(",")+1);var e={name:t.name,data:"data:image/png;base64,"+i};o.uploadFiles.push(e)}}},textMsg(){this.maxlength=this.message.length},submitContent(){const t=this.message.trim();if(t.length<=0)return void alert("Message is Empty");if(this.message.length>this.maxLengthLimit)return void alert(this.messageErrorMsg);if(this.uploadFiles.length>this.picturesLengthLimit)return void alert(this.picturesErrorMsg);if(this.isUploadOverSizeLimit)return void alert(this.picturesSizeLimitErrorMsg);const e=Z(this.message),n=A(this.message);let s={content:this.message,imgs:this.uploadFiles,parentId:this.id,createDate:new Date,topics:e,note:n},i=this;this.submitContentActions(s).then((t=>{t&&(i.id.length>0?i.getContentByParentId(i.id):i.getContentList({id:""}),z(t.data.insertedId,!0),i.message="",i.uploadFiles=[],console.log("topics="+e+",note="+n),i.insertTopics(e).catch((t=>{t&&console.log(t)})),i.insertNote(n).catch((t=>{t&&console.log(t)})))}))}}},R=H,U=(0,p.Z)(R,P,$,!1,null,null,null),q=U.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content-basic box"},[n("div",{staticClass:"box-content"},[n("p",{staticClass:"content-date"},[t._v(" "+t._s(t._f("dateFormat_y_m_d_hm")(t.sprayersData.createDate))+" "),t.isWithdraw()?n("span",{staticClass:"width-draw",on:{click:function(e){return t.withdraw()}}},[t._v("↩️")]):t._e()]),n("p",{staticClass:"content-text",domProps:{innerHTML:t._s(t.sprayersData.content)}}),n("div",{staticClass:"content-img"},[n("viewer",t._l(t.sprayersData.imgs,(function(t,e){return n("img",{key:e,attrs:{src:t.data}})})),0)],1)]),n("sprayers-comment",{attrs:{id:t.sprayersData._id}})],1)},W=[],K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content-basic"},[n("div",{staticClass:"box-bottom"},[n("div",{class:["bottom-btn","Comment"===t.active?"active":""],on:{click:function(e){return t.isShowComment()}}},[t._v("⌨️ "+t._s(t.countComment))]),n("div",{staticClass:"bottom-btn",on:{click:function(e){return t.likeToSubmit(t.id)}}},[t._v("👍 "+t._s(t.countLike))])]),t.showComment?n("div",{staticClass:"box-comment"},[n("sprayers-text-area",{attrs:{submitType:"Comment"===t.active?"Transmit":"Comment",id:t.id}}),n("div",{staticClass:"comment-list"},t._l(t.sprayersComment[t.id],(function(e,s){return n("p",{key:s,staticClass:"content-list"},[t._v(" "+t._s(t._f("dateFormat_y_m_d_hm")(e.createDate))+": "+t._s(e.content)+" ")])})),0)],1):t._e()])},G=[],J={components:{SprayersTextArea:q},name:"SprayersComment",props:{id:{type:String,default:""}},computed:{...(0,g.rn)({sprayersComment:t=>t.content.sprayersComment})},data(){return{sprayersData:[],showComment:!1,active:"",countComment:0,countLike:0}},created:function(){this.countCommentByParentId(this.id).then((t=>{this.countComment=t.data})),this.getLike(this.id).then((t=>{this.countLike=t.data}))},methods:{...(0,g.nv)({getContentByParentId:"content/getContentByParentId",countCommentByParentId:"content/countCommentByParentId",likeSubmit:"content/likeSubmit",getLike:"content/getLike"}),isShowComment(){return this.active="Comment",this.showComment?(this.active="",this.showComment=!1):(this.id.length>0&&this.getContentByParentId(this.id),this.showComment=!0),this.showComment},likeToSubmit(t){++this.countLike,this.likeSubmit(t)}}},Q=J,X=(0,p.Z)(Q,K,G,!1,null,null,null),Y=X.exports,tt={components:{SprayersComment:Y},name:"SprayersBox",props:["sprayersData"],methods:{...(0,g.nv)({contentDelete:"content/contentDelete",getContentList:"content/getContentList"}),toInfo(t){this.$router.push({name:"info",params:{sprayersData:t},query:{id:t._id}})},isWithdraw(){return F(this.sprayersData._id)},withdraw(){this.contentDelete(this.sprayersData._id).then((t=>{console.log(t),this.getContentList({id:""})}))}}},et=tt,nt=(0,p.Z)(et,V,W,!1,null,null,null),st=nt.exports,it={name:"ContentHome",components:{SprayersTextArea:q,SprayersBox:st},computed:{...(0,g.rn)({sprayersData:t=>t.content.sprayersData})},data(){return{}},created(){let t={id:"",topic:this.$route.params.topic,note:this.$route.params.note};this.$watch((()=>this.$route.params),(e=>{t.topic=e.topic,t.note=e.note,this.getContentList(t)})),this.getContentList(t)},methods:{...(0,g.nv)({getContentList:"content/getContentList"})}},ot=it,at=(0,p.Z)(ot,j,I,!1,null,null,null),rt=at.exports,ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content-basic"},[n("div",{staticClass:"content-info"},[n("div",{staticClass:"box-content",on:{click:function(e){return t.toInfo()}}},[n("p",{staticClass:"content-text"},[t._v(" "+t._s(t.infoData.content)+" ")]),n("div",{staticClass:"content-img"},[n("viewer",t._l(t.infoData.imgs,(function(t,e){return n("img",{key:e,attrs:{src:t.data}})})),0)],1)])]),n("sprayers-comment",{attrs:{sprayersInfo:t.infoData.info}}),t._l(t.sprayersData,(function(e,s){return n("p",{key:s,staticClass:"content-list"},[t._v(" "+t._s(e.content)+" ")])}))],2)},lt=[],ut={components:{SprayersComment:Y},name:"ContentInfo",data(){return{infoData:this.$route.params.sprayersData,id:this.$route.query.id,sprayersData:[{name:"nick name",date:"Today 23:37",content:"sdfwe"},{name:"nick name",date:"Today 23:37",content:"fskfjkasjfdsajdflkjsdlf"}]}},methods:{...(0,g.nv)({getContentById:"content/getContentById"})}},mt=ut,pt=(0,p.Z)(mt,ct,lt,!1,null,null,null),dt=pt.exports,ht=n(345),gt=n(669),ft=n.n(gt),_t={get_content_list(t){return ft().post("/api/",t)},submit_content(t){return ft().post("/api/submit",t)},get_content_by_id(t){return ft().get("/api/get?id="+t)},get_content_by_parent_id(t){return ft().get("/api/getByParentId?id="+t)},count_comment_by_parent_id(t){return ft().get("/api/countComment?id="+t)},like_width_id(t){return ft().get("/api/like/?id="+t)},get_like_by_id(t){return ft().get("/api/like/getLike?id="+t)},get_topic_top(){return ft().get("/api/topic/getTopicTop")},trends_topic(t){if(null!=t&&""!=t)return ft().get("/api/topic/?topic="+t)},insert_Topics(t){return ft().post("/api/topic/insertTopic",t)},get_note_list(){return ft().get("/api/note/getNoteList")},insert_Note(t){return ft().post("api/note/insert",t)},content_delete(t){return ft().get("/api/delete/?id="+t)}};s["default"].use(ht.Z);const yt=[{path:"/",name:"home",component:rt},{path:"/topic/:topic",name:"topic",component:rt},{path:"/note/:note",name:"note",component:rt},{path:"/info",name:"info",component:dt}],vt=new ht.Z({routes:yt});vt.beforeEach(((t,e,n)=>{if("topic"==t.name){const e=t.params.topic.replaceAll("#","%23");_t.trends_topic(e)}n()}));var Ct=vt,bt=n(784),wt=n(273),kt=n.n(wt),xt=n(346);function Lt(t,e,n){return new Promise(((s,i)=>{t.then((t=>{t.status?(e.commit(n,t),s(!0)):(e.commit(n,t),i(!1))}),(t=>{const e=t.response;500==e.status&&alert(e.data),i(t.response)}))}))}function Tt(t){return new Promise(((e,n)=>{t.then((t=>{t.status?e(t):n(t)}),(t=>{const e=t.response;500==e.status&&alert(e.data),n(t.response)}))}))}const St={sprayersData:[],sprayersComment:{},topicTop:[],note:[]},Et={getContentList(t,e){let n;for(n in e.data){let t=e.data[n];t.content=N(t.content),t.content=O(t.content)}t.sprayersData=e.data},addContentList(t,e){t.sprayersData=t.sprayersData.concat(e.data)},getCommentById(t,e){e.data.length>0&&s["default"].set(t.sprayersComment,e.data[0].parentId,e.data)},addCommentById(t,e){let n=t.sprayersComment[e.parentId];n||(n=[]),n.push(e),s["default"].set(t.sprayersComment,e.parentId,n)},getTopicTop(t,e){e&&(t.topicTop=e.data)},getNoteList(t,e){e&&(t.note=e.data)}},Dt={getContentList(t,e){let n="getContentList";return e.id.length>0&&(n="addContentList"),Lt(_t.get_content_list(e),t,n)},submitContent(t,e){return Tt(_t.submit_content(e))},getContentById(t,e){return Tt(_t.get_content_by_id(e))},getContentByParentId(t,e){return Lt(_t.get_content_by_parent_id(e),t,"getCommentById")},countCommentByParentId(t,e){return Tt(_t.count_comment_by_parent_id(e))},likeSubmit(t,e){return Tt(_t.like_width_id(e))},getLike(t,e){return Tt(_t.get_like_by_id(e))},getTopicTop(t){return Lt(_t.get_topic_top(),t,"getTopicTop")},insertTopics(t,e){return Tt(_t.insert_Topics(e))},insertNote(t,e){return Tt(_t.insert_Note(e))},getNoteList(t){return Lt(_t.get_note_list(),t,"getNoteList")},contentDelete(t,e){return Tt(_t.content_delete(e))}};var jt={namespaced:!0,actions:Dt,state:St,mutations:Et};s["default"].use(g.ZP);var It=new g.ZP.Store({debug:!0,state:{message:"every sprayer is create by yourself"},modules:{content:jt},getters:{sprayersData:()=>jt.state.sprayersData}});s["default"].filter("dateFormat_y_m_d_hm",(t=>B(t))),s["default"].filter("analyse_topic_to_html",(t=>N(t))),s["default"].filter("analyse_note_to_html",(t=>O(t)));var Pt=n(123),$t=n.n(Pt);let Bt=!0;window.onscroll=function(){const{scrollTop:t,clientHeight:e,scrollHeight:n}=window.document.scrollingElement,s=It.getters.sprayersData;if(t+e>.9*n&&Bt&&s.length>=20){Bt=!1;let t=s[s.length-1];null==t&&(t={_id:""});let e="";null!=Ct.history.current.params.topic&&(e=Ct.history.current.params.topic);let n={id:t._id,topic:e};It.dispatch("content/getContentList",n).then((t=>{t&&(Bt=!0)}))}},s["default"].config.productionTip=!1,s["default"].use(bt.ZP),s["default"].use(kt()),s["default"].use(xt.Z,ft()),s["default"].use($t()),new s["default"]({render:t=>t(D),router:Ct,store:It}).$mount("#app")}},e={};function n(s){var i=e[s];if(void 0!==i)return i.exports;var o=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=t,function(){n.amdO={}}(),function(){var t=[];n.O=function(e,s,i,o){if(!s){var a=1/0;for(u=0;u<t.length;u++){s=t[u][0],i=t[u][1],o=t[u][2];for(var r=!0,c=0;c<s.length;c++)(!1&o||a>=o)&&Object.keys(n.O).every((function(t){return n.O[t](s[c])}))?s.splice(c--,1):(r=!1,o<a&&(a=o));if(r){t.splice(u--,1);var l=i();void 0!==l&&(e=l)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[s,i,o]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,o,a=s[0],r=s[1],c=s[2],l=0;if(a.some((function(e){return 0!==t[e]}))){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(c)var u=c(n)}for(e&&e(s);l<a.length;l++)o=a[l],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(u)},s=self["webpackChunksprayers_vue"]=self["webpackChunksprayers_vue"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(757)}));s=n.O(s)})();
//# sourceMappingURL=app.dfe99398.js.map